!function(a){"function"==typeof define&&define.amd?define(["jquery","fuelux/repeater"],a):"object"==typeof exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){function b(b,c,d,e,f){var g=e[f].className,h=c[d][e[f].property],i=a("<td></td>"),j=e[f]._auto_width,k=e[f].property;this.viewOptions.list_actions!==!1&&"@_ACTIONS_@"===k&&(h='<div class="repeater-list-actions-placeholder" style="width: '+this.list_actions_width+'"></div>'),h=void 0!==h?h:"",i.addClass(void 0!==g?g:"").append(h),void 0!==j&&i.outerWidth(j),b.append(i),this.viewOptions.list_columnRendered&&this.viewOptions.list_columnRendered({container:b,columnAttr:e[f].property,item:i,rowData:c[d]},function(){})}function c(b,c,d){var e,f,g,h,i,j="glyphicon-chevron-down",k=".glyphicon.rlc:first",l="glyphicon-chevron-up",m=a('<div class="repeater-list-heading"><span class="glyphicon rlc"></span></div>'),n=a("<th></th>"),o=this;if(m.data("fu_item_index",d),m.prepend(c[d].label),n.html(m.html()).find("[id]").removeAttr("id"),n.append(m),e=n.add(m),h=m.find(k),i=h.add(n.find(k)),this.viewOptions.list_actions&&"@_ACTIONS_@"===c[d].property){var p=this.list_actions_width;n.css("width",p),m.css("width",p)}f=c[d].className,void 0!==f&&e.addClass(f),g=c[d].sortable,g&&(e.addClass("sortable"),m.on("click.fu.repeaterList",function(){o.list_sortProperty="string"==typeof g?g:c[d].property,m.hasClass("sorted")?h.hasClass(l)?(i.removeClass(l).addClass(j),o.list_sortDirection="desc"):o.viewOptions.list_sortClearing?(e.removeClass("sorted"),i.removeClass(j),o.list_sortDirection=null,o.list_sortProperty=null):(i.removeClass(j).addClass(l),o.list_sortDirection="asc"):(b.find("th, .repeater-list-heading").removeClass("sorted"),i.removeClass(j).addClass(l),o.list_sortDirection="asc",e.addClass("sorted")),o.render({clearInfinite:!0,pageIncrement:null})})),"asc"!==c[d].sortDirection&&"desc"!==c[d].sortDirection||(b.find("th, .repeater-list-heading").removeClass("sorted"),e.addClass("sortable sorted"),"asc"===c[d].sortDirection?(i.addClass(l),this.list_sortDirection="asc"):(i.addClass(j),this.list_sortDirection="desc"),this.list_sortProperty="string"==typeof g?g:c[d].property),b.append(n)}function d(c,d,e){var f,g,h=a("<tr></tr>"),i=this;for(this.viewOptions.list_selectable&&(h.addClass("selectable"),h.attr("tabindex",0),h.data("item_data",d[e]),h.on("click.fu.repeaterList",function(){var b=a(this);b.hasClass("selected")?(b.removeClass("selected"),b.find(".repeater-list-check").remove(),i.$element.trigger("deselected.fu.repeaterList",b)):("multi"!==i.viewOptions.list_selectable&&(i.$canvas.find(".repeater-list-check").remove(),i.$canvas.find(".repeater-list tbody tr.selected").each(function(){a(this).removeClass("selected"),i.$element.trigger("deselected.fu.repeaterList",a(this))})),b.addClass("selected"),b.find("td:first").prepend('<div class="repeater-list-check"><span class="glyphicon glyphicon-ok"></span></div>'),i.$element.trigger("selected.fu.repeaterList",b))}),h.keyup(function(a){13===a.keyCode&&h.trigger("click.fu.repeaterList")})),this.viewOptions.list_actions&&!this.viewOptions.list_selectable&&h.data("item_data",d[e]),c.append(h),f=0,g=this.list_columns.length;g>f;f++)b.call(this,h,d,e,this.list_columns,f);this.viewOptions.list_rowRendered&&this.viewOptions.list_rowRendered({container:c,item:h,rowData:d[e]},function(){})}function e(b,c){var d,e=b.find("tbody");e.length<1&&(e=a('<tbody data-container="true"></tbody>'),b.append(e)),c.items&&c.items.length<1&&(d=a('<tr class="empty"><td colspan="'+this.list_columns.length+'"></td></tr>'),d.find("td").append(this.viewOptions.list_noItemsHTML),e.append(d))}function f(b,d){function e(a,b){if(!b)return!1;if(!a||b.length!==a.length)return!0;for(f=0,i=b.length;i>f;f++){if(!a[f])return!0;for(h in b[f])if(a[f][h]!==b[f][h])return!0}return!1}var f,h,i,j,k=d.columns||[],l=b.find("thead");if(this.list_firstRender||e(this.list_columns,k)||0===l.length){if(l.remove(),this.list_columns=k,this.list_firstRender=!1,this.$loader.removeClass("noHeader"),this.viewOptions.list_actions){var m={label:this.viewOptions.list_actions.label||'<span class="actions-hidden">a</span>',property:"@_ACTIONS_@",sortable:!1,width:this.list_actions_width};k.push(m)}for(l=a('<thead data-preserve="deep"><tr></tr></thead>'),j=l.find("tr"),f=0,i=k.length;i>f;f++)c.call(this,j,k,f);b.prepend(l),g.call(this,j)}}function g(b){var c,d,e,f,g=[],h=this;if(this.viewOptions.list_columnSizing&&(c=0,f=0,b.find("th").each(function(){var b,d=a(this),e=0===d.next("th").length;void 0!==h.list_columns[c].width?(b=h.list_columns[c].width,d.outerWidth(b),f+=d.outerWidth(),e?d.outerWidth(""):h.list_columns[c]._auto_width=b):g.push({col:d,index:c,last:e}),c++}),d=g.length,d>0))for(e=Math.floor((this.$canvas.width()-f)/d),c=0;d>c;c++)g[c].last||(g[c].col.outerWidth(e),this.list_columns[g[c].index]._auto_width=e)}function h(){var a=window.navigator.userAgent,b=a.indexOf("MSIE "),c=a.indexOf("Firefox");return b>0?"ie-"+parseInt(a.substring(b+5,a.indexOf(".",b))):c>0?"firefox":""}a.fn.repeater&&(a.fn.repeater.Constructor.prototype.list_clearSelectedItems=function(){this.$canvas.find(".repeater-list-check").remove(),this.$canvas.find(".repeater-list table tbody tr.selected").removeClass("selected")},a.fn.repeater.Constructor.prototype.list_highlightColumn=function(b,c){var d=this.$canvas.find(".repeater-list tbody");(this.viewOptions.list_highlightSortedColumn||c)&&(d.find("td.sorted").removeClass("sorted"),d.find("tr").each(function(){var c=a(this).find("td:nth-child("+(b+1)+")");c.addClass("sorted")}))},a.fn.repeater.Constructor.prototype.list_getSelectedItems=function(){var b=[];return this.$canvas.find(".repeater-list table tbody tr.selected").each(function(){var c=a(this);b.push({data:c.data("item_data"),element:c})}),b},a.fn.repeater.Constructor.prototype.list_positionHeadings=function(){var b=this.$element.find(".repeater-list-wrapper"),c=b.offset().left,d=b.scrollLeft();d>0?b.find(".repeater-list-heading").each(function(){var b=a(this),d=b.parents("th:first").offset().left-c+"px";b.addClass("shifted").css("left",d)}):b.find(".repeater-list-heading").each(function(){a(this).removeClass("shifted").css("left","")})},a.fn.repeater.Constructor.prototype.list_setSelectedItems=function(b,c){function d(){h=a(this),f=h.data("item_data")||{},f[b[g].property]===b[g].value&&e(h,b[g].selected)}function e(a,b){b=void 0!==b?b:!0,b?(c||"multi"===j||k.list_clearSelectedItems(),a.hasClass("selected")||(a.addClass("selected"),a.find("td:first").prepend('<div class="repeater-list-check"><span class="glyphicon glyphicon-ok"></span></div>'))):(a.find(".repeater-list-check").remove(),a.removeClass("selected"))}var f,g,h,i,j=this.viewOptions.list_selectable,k=this;for(a.isArray(b)||(b=[b]),i=c===!0||"multi"===j?b.length:j&&b.length>0?1:0,g=0;i>g;g++)void 0!==b[g].index?(h=this.$canvas.find(".repeater-list table tbody tr:nth-child("+(b[g].index+1)+")"),h.length>0&&e(h,b[g].selected)):void 0!==b[g].property&&void 0!==b[g].value&&this.$canvas.find(".repeater-list table tbody tr").each(d)},a.fn.repeater.Constructor.prototype.list_sizeHeadings=function(){var b=this.$element.find(".repeater-list table");b.find("thead th").each(function(){var b=a(this),c=b.find(".repeater-list-heading");c.outerHeight(b.outerHeight()),c.outerWidth(b.outerWidth())})},a.fn.repeater.Constructor.prototype.list_setFrozenColumns=function(){var b=this.$canvas.find(".table-frozen"),c=this.$element.find(".repeater-list .repeater-list-wrapper > table"),d=this.$element.find(".repeater-list"),e=this.viewOptions.list_frozenColumns;if(b.length<1){var f=a('<div class="frozen-column-wrapper"></div>').insertBefore(c),g=c.clone().addClass("table-frozen");g.find("th:not(:lt("+e+"))").remove(),g.find("td:not(:nth-child(n+0):nth-child(-n+"+e+"))").remove();var h=g.clone().removeClass("table-frozen");h.find("tbody").remove();var i=a('<div class="frozen-thead-wrapper"></div>').append(h);f.append(g),d.append(i),this.$canvas.addClass("frozen-enabled")}this.$element.find(".repeater-list table.table-frozen tr").each(function(b,d){a(this).height(c.find("tr:eq("+b+")").height())});var j=c.find("td:eq(0)").outerWidth();this.$element.find(".frozen-column-wrapper, .frozen-thead-wrapper").width(j)},a.fn.repeater.Constructor.prototype.list_positionColumns=function(){var a=this.$element.find(".repeater-canvas"),b=a.scrollTop(),c=a.scrollLeft(),d=this.viewOptions.list_frozenColumns,e=this.viewOptions.list_actions,f=this.$element.find(".repeater-canvas").outerWidth(),g=this.$element.find(".repeater-list .repeater-list-wrapper > table").outerWidth(),h=this.$element.find(".table-actions")?this.$element.find(".table-actions").outerWidth():0,i=g-(f-h)>=c;b>0?a.find(".repeater-list-heading").css("top",b):a.find(".repeater-list-heading").css("top","0"),c>0?(d&&(a.find(".frozen-thead-wrapper").css("left",c),a.find(".frozen-column-wrapper").css("left",c)),e&&i&&(a.find(".actions-thead-wrapper").css("right",-c),a.find(".actions-column-wrapper").css("right",-c))):(d&&(a.find(".frozen-thead-wrapper").css("left","0"),a.find(".frozen-column-wrapper").css("left","0")),e&&(a.find(".actions-thead-wrapper").css("right","0"),a.find(".actions-column-wrapper").css("right","0")))},a.fn.repeater.Constructor.prototype.list_createItemActions=function(){var b,c,d="",e=this,f=this.$element.find(".repeater-list .repeater-list-wrapper > table"),g=this.$canvas.find(".table-actions");for(b=0,c=this.viewOptions.list_actions.items.length;c>b;b++){var h=this.viewOptions.list_actions.items[b],i=h.html();d+='<li><a data-action="'+h.name+'" class="action-item"> '+i+"</a></li>"}var j='<div class="btn-group"><button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><span class="caret"></span></button><ul class="dropdown-menu dropdown-menu-right" role="menu">'+d+"</ul></div>";if(g.length<1){var k=a('<div class="actions-column-wrapper"></div>').insertBefore(f),l=f.clone().addClass("table-actions");if(l.find("th:not(:lt(1))").remove(),l.find("td:not(:nth-child(n+0):nth-child(-n+1))").remove(),"multi"===this.viewOptions.list_selectable)l.find("thead tr").html('<th><div class="repeater-list-heading">'+j+"</div></th>");else{var m=this.viewOptions.list_actions.label||'<span class="actions-hidden">a</span>';l.find("thead tr").addClass("empty-heading").html("<th>"+m+'<div class="repeater-list-heading">'+m+"</div></th>")}var n=l.find("td");n.each(function(b){a(this).html(j),a(this).find("a").attr("data-row",parseInt([b])+1)}),k.append(l),this.$canvas.addClass("actions-enabled")}this.$element.find(".repeater-list .actions-column-wrapper, .repeater-list .actions-column-wrapper td, .repeater-list .actions-column-wrapper th").css("width",this.list_actions_width),this.$element.find(".repeater-list .actions-column-wrapper th .repeater-list-heading").css("width",parseInt(this.list_actions_width)+1+"px"),this.$element.find(".repeater-list table.table-actions tr").each(function(b,c){a(this).height(f.find("tr:eq("+b+")").height())}),this.$element.find(".table-actions .action-item").on("click",function(){var b=a(this).data("action"),c=a(this).data("row");e.list_getActionItems(b,c)})},a.fn.repeater.Constructor.prototype.list_getActionItems=function(b,c){var d=this.$canvas.find(".repeater-list-wrapper > table tbody tr:nth-child("+c+")"),e=a.grep(this.viewOptions.list_actions.items,function(a){return a.name===b})[0];e.clickAction&&e.clickAction({item:d,rowData:d.data("item_data")},function(){})},a.fn.repeater.Constructor.prototype.list_sizeActionsTable=function(){var a=this.$element.find(".repeater-list-wrapper > table"),b=this.$element.find(".repeater-list-wrapper .actions-column-wrapper thead th .repeater-list-heading");b.outerHeight(a.find("thead th .repeater-list-heading").outerHeight())},a.fn.repeater.defaults=a.extend({},a.fn.repeater.defaults,{list_columnRendered:null,list_columnSizing:!0,list_columnSyncing:!0,list_highlightSortedColumn:!0,list_infiniteScroll:!1,list_noItemsHTML:"no items found",list_selectable:!1,list_sortClearing:!1,list_rowRendered:null,list_frozenColumns:0,list_actions:!1}),a.fn.repeater.viewTypes.list={cleared:function(){this.viewOptions.list_columnSyncing&&this.list_sizeHeadings()},dataOptions:function(a){return this.list_sortDirection&&(a.sortDirection=this.list_sortDirection),this.list_sortProperty&&(a.sortProperty=this.list_sortProperty),a},initialize:function(a,b){this.list_sortDirection=null,this.list_sortProperty=null,this.list_actions_width=void 0!==this.viewOptions.list_actions.width?this.viewOptions.list_actions.width:"37px",b()},resize:function(){this.viewOptions.list_columnSyncing&&this.list_sizeHeadings()},selected:function(){var a,b=this.viewOptions.list_infiniteScroll;this.list_firstRender=!0,this.$loader.addClass("noHeader"),b&&(a="object"==typeof b?b:{},this.infiniteScrolling(!0,a))},before:function(b){var c,d=b.container.find(".repeater-list"),g=this;return d.length<1&&(d=a('<div class="repeater-list '+h()+'" data-preserve="shallow"><div class="repeater-list-wrapper" data-infinite="true" data-preserve="shallow"><table aria-readonly="true" class="table" data-preserve="shallow" role="grid"></table></div></div>'),d.find(".repeater-list-wrapper").on("scroll.fu.repeaterList",function(){g.viewOptions.list_columnSyncing&&g.list_positionHeadings()}),(g.viewOptions.list_frozenColumns||g.viewOptions.list_actions)&&b.container.on("scroll.fu.repeaterList",function(){g.list_positionColumns()}),b.container.append(d)),c=d.find("table"),f.call(this,c,b.data),e.call(this,c,b.data),!1},renderItem:function(a){return d.call(this,a.container,a.subset,a.index),!1},after:function(){var a;return this.viewOptions.list_columnSyncing&&(this.list_sizeHeadings(),this.list_positionHeadings()),this.viewOptions.list_frozenColumns&&this.list_setFrozenColumns(),this.viewOptions.list_actions&&(this.list_createItemActions(),this.list_sizeActionsTable()),(this.viewOptions.list_frozenColumns||this.viewOptions.list_actions)&&this.list_positionColumns(),a=this.$canvas.find(".repeater-list-heading.sorted"),a.length>0&&this.list_highlightColumn(a.data("fu_item_index")),!1}})});